function listRazonCancelacion(){const e={method:"GET",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"}};fetch(base+"/reservar/razones",e).then(e=>e.json()).then(function(e){var a='<option value="">Seleccione</option>';e.forEach(function(e){a+='<option value="'+e.id+'">'+e.razon+"</option>"}),$("#raz_canc").html(a)})}function continuar(e){"EVENTO"==e[0].tipo||"PRERESERVA"==e[0].tipo?($("#pax").val($("#pasajeros").val()),$("#panel_eventos").css("visibility","visible")):$("#panel_eventos").css("visibility","hidden"),$("#clave_usuario").val(""),$("#mdl-vreserva").modal("toggle")}function sucursal(e){let a="VIVO";1==e&&(a=$("#selSucursal option:selected").text().replace(/\s/g,"")),"Todas"==a?$(".evento").show():($(".evento").not("."+a).hide(),$(".evento."+a).show())}function agregarEtiquetas(e,a){a.append('<span class="etiqueta">Etiqueta</span>')}function actualizar(){const e={method:"GET",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"}};fetch(base+"/clientes/clienteslista",e).then(e=>e.json()).then(function(e){$("#listaClientes").empty(),e.forEach(function(e){$("#listaClientes").append('<option value="'+e.nombre+'">')})}),fetch(base+"/clientes/clientesempresas",e).then(e=>e.json()).then(function(e){$("#listaEmpresas").empty(),e.forEach(function(e){$("#listaEmpresas").append('<option value="'+e.empresa+'">')})}),fetch(base+"/clientes/clienteshoteles",e).then(e=>e.json()).then(function(e){$("#listaHoteles").empty(),e.forEach(function(e){$("#listaHoteles").append('<option value="'+e.hotel+'">')})}),fetch(base+"/clientes/clientestelefonos").then(e=>e.json()).then(function(e){$("#listaTelefonos").empty(),e.forEach(function(e){$("#listaTelefonos").append('<option value="'+e.telefono+'">')})}),fetch(base+"/clientes/clientescorreos",e).then(e=>e.json()).then(function(e){$("#listaCorreos").empty(),e.forEach(function(e){$("#listaCorreos").append('<option value="'+e.email+'">')})})}function imageFormatter(e){let a=null,t=null;if(null==e)return'<img src="https://dataloggers.nyc3.digitaloceanspaces.com/b94_reservas2/reserva/4d91dca73fbeb2f3694f15aa32912fde004d5838.png" height="75px" width="75px">';if(""==e)return'<img src="https://dataloggers.nyc3.digitaloceanspaces.com/b94_reservas2/reserva/4d91dca73fbeb2f3694f15aa32912fde004d5838.png" height="75px" width="75px">';{let o=e.substring(e.length-3);switch(o){case"pdf":t=1,a="https://dataloggers.nyc3.digitaloceanspaces.com/b94_reservas2/reserva/272a0577357ca4502d5111c5af4228fe22810758.png";break;case"png":t=1,a="https://dataloggers.nyc3.digitaloceanspaces.com/b94_reservas2/reserva/753821c946a3ac5755c8d9b92907c09318e031ad.png";break;case"jpg":case"jpeg":t=1,a="https://dataloggers.nyc3.digitaloceanspaces.com/b94_reservas2/reserva/753821c946a3ac5755c8d9b92907c09318e031ad.png";break;default:t=null,a="https://dataloggers.nyc3.digitaloceanspaces.com/b94_reservas2/reserva/4d91dca73fbeb2f3694f15aa32912fde004d5838.png"}return'<a href="'+e+'"><img src="'+a+'" height="75px" width="75px"></a>'}}function filtrarEventos(){if(calendar){let e=$("#external-events input:checked").map(function(){return $(this).attr("title")}).get().join(", "),a=$("#selTurno option:selected").text(),t=etiquetasSeparadas=$("#selEstado option:selected").map(function(){return $(this).text()}).get().join(", "),o=calendar.getEvents();o.forEach(function(o){if(e.indexOf(o.extendedProps.tipo)>-1&&(a.toUpperCase().indexOf(o.extendedProps.dianoche)>-1||"Todas"==a)&&t.indexOf(o.extendedProps.testado)>-1)o.setProp("display","block");else{let e=o.extendedProps.fecha_reserva,a=`lblpopover.lbl-${e}`;$(`.${a}`).remove(),o.setProp("display","none")}}),fechas()}}function fechas(){calendar.view;let e=calendar.getDate(),a=moment(e).startOf("month"),t=moment(a).endOf("month"),o=calendar.getEvents(a,t),n=o.filter(function(e){return"none"!==e.display}),r=n.map(function(e){return e.start});r.map(function(e){return getTotalPaxForDate(e.toISOString().slice(0,10)),e.toISOString().slice(0,10)})}function getTotalPaxForDate(e){let a=calendar.getEvents();a.forEach(function(a){moment(a.start).format("YYYY-MM-DD")==e&&"Cancelada"!==a.extendedProps.testado&&"Rechazada"!==a.extendedProps.testado&&"No Show"!==a.extendedProps.testado&&(totalPax=a.extendedProps.total_pax)}),pax(e,totalPax)}function pax(e,a){if(null!==a){let t=$("*[data-date='"+e+"']").html();if(t&&-1==t.indexOf("Pax")){moment(e).format("YYYYMMDD");let t=null;t="rgb(255, 0, 0)"==$("*[data-date='"+e+"']").css("background-color")?"white":"black";let o="<a fref='#' class='btn lblpopover lbl-"+e+"'>Pax: "+a+"</a>";$("[data-date='"+e+"'] .fc-daygrid-day-number").after(o).next("a").addClass("bg-dark").css("color","white").css("font-weight","bold").css("padding","2%").css("float","left").css("margin-right","25%").css("margin-top","4%").css("font-size","80%").css("z-index",999999999999999),$(".lbl-"+e).on("click",function(a){etq_pax=!0,a.preventDefault(),a.stopPropagation();var t=window.open(base+"/","_blank");$(t).on("load",function(){etq_pax=!1,$("#fecha",t.document).val(e)})})}if("timeGridWeek"===calendar.view.type){const t=moment(e),o=t.format("D/M");$('a.fc-col-header-cell-cushion:contains("'+o+'")').each(function(){const e=$(this).next(".pax").length;!e&&a>0&&$(this).after('<span class="pax">PAX: '+a+"</span>")})}}}function vistaActual(e){if("timeGridWeek"===calendar.view.type){e.toLocaleString("es",{weekday:"long"});$(".fc-scrollgrid-sync-inner").append("<br>Pax: 25")}}function onMonthChange(){setTimeout(()=>{filtrarEventos()},1500);let e=calendar.getDate(),a=moment(e).format("YYYY-MM-DD");$(".cant_tipo").html(0),$.get(base+"/calendario/tipos_mes/"+a,function(e){let a=JSON.parse(e);a.forEach(function(e){$("#det_"+e.tipo).html(e.cant)})})}function mostrarReservas(e,a){a.preventDefault(),console.log(e)}function editar(e){$("#div_passwd").show(),$(".requerido").show(),$("#tipo").hide(),$("#sucursal").hide(),$("#salon").hide(),$("#mesa").hide(),$("#pago_local").hide(),$("#audio").hide(),$("#video").hide(),$("#video_audio").hide(),$("#adicional").hide(),$("#extra").hide(),$("#menu_impreso").hide(),$("#table_tent").hide(),$("#restriccion").hide(),$("#tipo_reserva").show(),$("#ssucursal").show(),$("#ssalon").show(),$("#smesa").show(),$("#spago_local").show(),$("#saudio").show(),$("#svideo").show(),$("#svideo_audio").show(),$("#sadicional").show(),$("#sextra").show(),$("#smenu_impreso").show(),$("#stable_tent").show(),$("#srestriccion").show(),$("#fmenu1").show(),$("#fmenu2").show(),$("#fprecuenta").show(),$("#ffactura").show(),$("#flogo").show(),$("#fotro").show(),$(".clear_fmenu1").show().attr("data-id",e),$(".clear_fmenu2").show().attr("data-id",e),$(".clear_fprecuenta").show().attr("data-id",e),$(".clear_ffactura").show().attr("data-id",e),$(".clear_flogo").show().attr("data-id",e),$(".clear_fotro").show().attr("data-id",e),$("#fecha_reserva").attr("disabled",!1),$("#hora_reserva").attr("disabled",!1),$("#pasajeros").attr("disabled",!1),$("#cliente").attr("disabled",!1),$("#empresa").attr("disabled",!1),$("#hotel").attr("disabled",!1),$("#telefono").attr("disabled",!1),$("#correo").attr("disabled",!1),$("#observaciones").attr("disabled",!1),$("#nombre_adicional").attr("disabled",!1),$("#pax").attr("disabled",!1),$("#nombre_contacto").attr("disabled",!1),$("#telefono_contacto").attr("disabled",!1),$("#correo_contacto").attr("disabled",!1),$("#idioma").attr("disabled",!1),$("#cristaleria").attr("disabled",!1),$("#anticipo").attr("disabled",!1),$("#valor_menu").attr("disabled",!1),$("#total_s_propina").attr("disabled",!1),$("#total_c_propina").attr("disabled",!1),$("#autoriza").attr("disabled",!1),$("#telefono_autoriza").attr("disabled",!1),$("#monto_autorizado").attr("disabled",!1),$("#detalle_restriccion").attr("disabled",!1),$("#decoracion").attr("disabled",!1),$("#ubicacion").attr("disabled",!1),$("#monta").attr("disabled",!1),$("#comentarios").attr("disabled",!1),$("#id_reserva").html("Editar Reserva ID: "+e),$('a[href="#general"]')[0].click(),$.ajax({url:base+"/reservar/get_reserva/"+e,type:"get",dataType:"json",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},success:function(e){console.log(e[0]),$("#fecha_reserva").val(e[0].fecha_reserva),$("#hora_reserva").val(e[0].hora_reserva),$("#pasajeros").val(e[0].cantidad_pasajeros),$("#tipo").val(e[0].tipo_reserva),listTipos(e[0].tipo_reserva),$("#tipo_reserva").val(e[0].tipo_reserva),$("#cliente").val(e[0].nombre_cliente),$("#empresa").val(e[0].nombre_empresa),$("#hotel").val(e[0].nombre_hotel),$("#telefono").val(e[0].telefono_cliente),$("#correo").val(e[0].email_cliente),$("#ssucursal").val(e[0].sucursal),listSucursales(e[0].sucursal),listSalones(e[0].salon,e[0].sucursal),listMesas(e[0].mesa,e[0].salon),$("#observaciones").val(e[0].observaciones),$("#nombre_adicional").val(e[0].evento_nombre_adicional),$("#pax").val(e[0].evento_pax),$("#nombre_contacto").val(e[0].evento_nombre_contacto),$("#telefono_contacto").val(e[0].evento_telefono_contacto),$("#correo_contacto").val(e[0].evento_email_contacto),$("#idioma").val(e[0].evento_idioma),$("#cristaleria").val(e[0].evento_cristaleria),$("#anticipo").val(e[0].evento_anticipo),$("#valor_menu").val(e[0].evento_valor_menu),$("#total_s_propina").val(e[0].evento_total_sin_propina),$("#total_c_propina").val(e[0].evento_total_propina),$("#spago_local").val(e[0].evento_paga_en_local),$("#saudio").val(e[0].evento_audio),$("#svideo").val(e[0].evento_video),$("#svideo_audio").val(e[0].evento_video_audio),$("#sadicional").val(e[0].evento_mesa_soporte_adicional),$("#sextra").val(e[0].evento_extra_permitido),$("#autoriza").val(e[0].autoriza),$("#telefono_autoriza").val(e[0].telefono_autoriza),$("#monto_autorizado").val(e[0].monto_autorizado),$("#smenu_impreso").val(e[0].evento_menu_impreso),$("#stable_tent").val(e[0].evento_table_tent),$("#srestriccion").val(e[0].evento_restriccion_alimenticia),$("#detalle_restriccion").val(e[0].evento_detalle_restriccion),$("#decoracion").val(e[0].evento_decoracion),$("#monta").val(e[0].evento_monta),$("#ubicacion").val(e[0].evento_ubicacion),$("#comentarios").val(e[0].evento_comentarios),$("#rsalon").val(e[0].salon),$("#rmesa").val(e[0].mesa),$("#lnk_menu1").html(imageForm("lnk_menu1",e[0].archivo_1)),$("#lnk_menu2").html(imageForm("lnk_menu2",e[0].archivo_2)),$("#lnk_precuenta").html(imageForm("lnk_precuenta",e[0].archivo_3)),$("#lnk_factura").html(imageForm("lnk_factura",e[0].archivo_4)),$("#lnk_otro").html(imageForm("lnk_otro",e[0].archivo_5)),$("#lnk_logo").html(imageForm("lnk_logo",e[0].evento_logo)),continuar(e)}})}function cambiar_archivo(e,a,t){$("#"+e).html("");let o=$("#"+a),n=o.find("img");n.length>0&&n.remove();let r=$("#"+t)[0].files[0].type.indexOf("pdf"),l=$("#"+t)[0].files[0].type.indexOf("jpeg"),i=$("#"+t)[0].files[0].type.indexOf("jpg"),s=$("#"+t)[0].files[0].type.indexOf("png");if(-1==r&&-1==l&&-1==i&&-1==s)$("#"+t).val(null),toastr.error("El archivo no ha sido cargado debido a que sólo puede cargar archivos pdf, jpeg, jpg, png; intente de nuevo con un arcivo válido");else{r>-1?url="https://dataloggers.nyc3.digitaloceanspaces.com/b94_reservas2/reserva/272a0577357ca4502d5111c5af4228fe22810758.png":(l>-1||i>-1||s>-1)&&(url="https://dataloggers.nyc3.digitaloceanspaces.com/b94_reservas2/reserva/753821c946a3ac5755c8d9b92907c09318e031ad.png"),o.append('<img src="'+url+'" height="50px" width="50px" title="'+$("#"+t)[0].files[0].name+'"></img>');let a="";a=$(window).width()>992&&$("#"+t)[0].files[0].name.length>17?$("#"+t)[0].files[0].name.substring(0,14)+"...":$("#"+t)[0].files[0].name,$("#"+e).html(a),$("#"+e).attr("title",$("#"+t)[0].files[0].name)}}function limpiarArchivos(){$(".clear_fmenu1").on("click",function(){$("#fmenu1").val(""),""!=$("#lbl-fmenu1").html()&&($("#lbl-fmenu1").html(""),$("#lnk_menu1").html("")),borrarArchivo($(".clear_fmenu1").data("id"),"archivo_1","menu1")}),$(".clear_fmenu2").on("click",function(){$("#fmenu2").val(""),""!=$("#lbl-fmenu2").html()&&($("#lbl-fmenu2").html(""),$("#lnk_menu2").html("")),borrarArchivo($(".clear_fmenu2").data("id"),"archivo_2","menu2")}),$(".clear_fprecuenta").on("click",function(){$("#fprecuenta").val(""),""!=$("#lbl-fprecuenta").html()&&($("#lbl-fprecuenta").html(""),$("#lnk_precuenta").html("")),borrarArchivo($(".clear_fprecuenta").data("id"),"archivo_3","precuenta")}),$(".clear_ffactura").on("click",function(){$("#ffactura").val(""),""!=$("#lbl-ffactura").html()&&($("#lbl-ffactura").html(""),$("#lnk_factura").html("")),borrarArchivo($(".clear_ffactura").data("id"),"archivo_4","factura")}),$(".clear_fotro").on("click",function(){$("#fotro").val(""),""!=$("#lbl-fotro").html()&&($("#lbl-fotro").html(""),$("#lnk_otro").html("")),borrarArchivo($(".clear_fotro").data("id"),"archivo_5","otro")}),$(".clear_flogo").on("click",function(){$("#flogo").val(""),""!=$("#lbl-flogo").html()&&($("#lbl-flogo").html(""),$("#lnk_logo").html("")),borrarArchivo($(".clear_fotro").data("id"),"evento_logo","logo")})}function borrarArchivo(e,a,t){console.log(e,a);var o={id:e,columna:a};$.ajax({type:"POST",url:base+"/reservar/borrar_archivo",data:o,headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")},dataType:"JSON",success:function(e){1==e.status&&(console.log(e.data),"archivo_1"==a?""==e.data.archivo_1&&(toastr.success("Se ha eliminado el archivo "+t+" exitosamente"),$("#reservas_tbl").bootstrapTable("refresh")):"archivo_2"==a?""==e.data.archivo_1&&(toastr.success("Se ha eliminado el archivo "+t+" exitosamente"),$("#reservas_tbl").bootstrapTable("refresh")):"archivo_3"==a?""==e.data.archivo_1&&(toastr.success("Se ha eliminado el archivo "+t+" exitosamente"),$("#reservas_tbl").bootstrapTable("refresh")):"archivo_4"==a?""==e.data.archivo_1&&(toastr.success("Se ha eliminado el archivo "+t+" exitosamente"),$("#reservas_tbl").bootstrapTable("refresh")):"archivo_5"==a?""==e.data.archivo_1&&(toastr.success("Se ha eliminado el archivo "+t+" exitosamente"),$("#reservas_tbl").bootstrapTable("refresh")):"evento_logo"==a&&""==e.data.archivo_1&&(toastr.success("Se ha eliminado el archivo "+t+" exitosamente"),$("#reservas_tbl").bootstrapTable("refresh")),$("#lbl-f"+t).html(""),$("#lnk_"+t).html(""))}})}function actualizar_reserva(){const e=parseInt($("#id_reserva").html().substring($("#id_reserva").html().indexOf("ID: ")+4).trim());let a=null,t=moment($("#hora_reserva").val(),"h:mma");var o=moment("4:00pm","h:mma");a=t.isBefore(o)?1:2;const n=new FormData,r=void 0===$("#fmenu1")[0].files[0]?$("#arch1").val():$("#fmenu1")[0].files[0],l=void 0===$("#fmenu2")[0].files[0]?$("#arch2").val():$("#fmenu2")[0].files[0],i=void 0===$("#fprecuenta")[0].files[0]?$("#arch3").val():$("#fprecuenta")[0].files[0],s=void 0===$("#ffactura")[0].files[0]?$("#arch4").val():$("#ffactura")[0].files[0],c=void 0===$("#fotro")[0].files[0]?$("#arch5").val():$("#fotro")[0].files[0],d=void 0===$("#flogo")[0].files[0]?$("#arch6").val():$("#flogo")[0].files[0],v=$("#fecha_reserva").val(),p=$("#hora_reserva").val(),u="Seleccione"==$("#spago_local option:selected").val()?2:$("#spago_local option:selected").val(),m="Seleccione"==$("#saudio option:selected").val()?2:$("#saudio option:selected").val(),f="Seleccione"==$("#svideo option:selected").val()?2:$("#svideo option:selected").val(),h="Seleccione"==$("#svideo_audio option:selected").val()?2:$("#svideo_audio option:selected").val(),_="Seleccione"==$("#adicional option:selected").val()?2:$("#sadicional option:selected").val(),b=$("#ubicacion").val(),g="Seleccione"==$("#smenu_impreso option:selected").val()?2:$("#smenu_impreso option:selected").val(),x="Seleccione"==$("#stable_tent option:selected").val()?2:$("#stable_tent option:selected").val(),k="Seleccione"==$("#srestriccion option:selected").val()?2:$("#srestriccion option:selected").val(),C="Seleccione"==$("#sextra option:selected").val()?2:$("#sextra option:selected").val(),T=$("#detalle_restriccion").val();n.append("id",e),n.append("fecha_reserva",v),n.append("hora_reserva",p),n.append("pasajeros",$("#pasajeros").val()),n.append("tipo",$("#tipo_reserva option:selected").val()),n.append("cliente",$("#cliente").val().trim()),n.append("empresa",$("#empresa").val().trim()),n.append("hotel",$("#hotel").val().trim()),n.append("telefono",$("#telefono").val().trim()),n.append("correo",$("#correo").val().trim()),n.append("sucursal",$("#ssucursal option:selected").val()),n.append("salon",$("#ssalon option:selected").val()),n.append("mesa",$("#smesa option:selected").val()),n.append("observaciones",$("#observaciones").val().trim()),n.append("evento_nombre_adicional",$("#nombre_adicional").val().trim()),n.append("evento_pax",$("#pax").val()),n.append("evento_nombre_contacto",$("#nombre_contacto").val().trim()),n.append("evento_telefono_contacto",$("#telefono_contacto").val().trim()),n.append("evento_correo_contacto",$("#correo_contacto").val().trim()),n.append("evento_idioma",$("#idioma").val().trim()),n.append("evento_cristaleria",$("#cristaleria").val().trim()),n.append("evento_anticipo",$("#anticipo").val()),n.append("evento_valor_menu",$("#valor_menu").val()),n.append("evento_valor_menu",$("#valor_menu").val()),n.append("evento_total_sin_propina",$("#total_s_propina").val()),n.append("evento_total_propina",$("#total_c_propina").val()),n.append("evento_paga_en_local",u),n.append("evento_audio",m),n.append("evento_video",f),n.append("evento_video_audio",h),n.append("evento_mesa_soporte_adicional",_),n.append("evento_ubicacion",b),n.append("evento_menu_impreso",g),n.append("evento_table_tent",x),n.append("evento_restriccion_alimenticia",k),n.append("evento_detalle_restriccion",T),n.append("evento_extra_permitido",C),n.append("autoriza",$("#autoriza").val()),n.append("telefono_autoriza",$("#telefono_autoriza").val()),n.append("monto_autorizado",$("#monto_autorizado").val()),n.append("evento_decoracion",$("#decoracion").val()),n.append("ambiente",$("#ubicacion").val()),n.append("evento_monta",$("#monta").val()),n.append("evento_comentarios",$("#comentarios").val()),n.append("dianoche",a),n.append("archivo_1",r),n.append("archivo_2",l),n.append("archivo_3",i),n.append("archivo_4",s),n.append("archivo_5",c),n.append("evento_logo",d);const y={method:"POST",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")},body:n};fetch(base+"/reservar/actualizar",y).then(e=>e.json()).then(function(e){0==e[0].status?toastr.error(e[0].error):($("#frm-general").trigger("reset"),$("#frm-evento").trigger("reset"),$("#clave").val(""),$("#panel_eventos").css("visibility","hidden"),Swal.fire({title:"La reserva ha sido actualizada exitosamente",text:"",icon:"success",confirmButtonColor:"#51d28c",confirmButtonText:"Continuar"}).then(function(e){$("#mdl-vreserva").modal("toggle"),pax(0),$("#reservas_tbl").bootstrapTable("refresh")}))})}function validar(){let e=!0;return $("#frm_reservas .req").each(function(){let a=null;switch($(this)[0].tagName){case"INPUT":a=$(this)[0].id,0==$("#"+a).val().length&&$("#"+a).is(":visible")&&(e=!1,$("#err_"+a).html("Campo obligatorio"));break;case"SELECT":a=$(this)[0].id,"Seleccione"!=$("#"+a+" option:selected").val()&&null!=$("#"+a+" option:selected").val()||(e=!1,$("#err_"+a).html("Campo obligatorio"))}}),e}var etq_pax,calendar,nfo,propiedades=[];$.LoadingOverlaySetup({background:"rgba(0, 0, 0, 0.5)"}),$(document).ready(function(){function e(){}function a(){$.LoadingOverlay("show");var a=$(".can-cancelar-reserva").length?"":"disabled",n=$(".can-no-show-reserva").length?"":"disabled",l=$(".can-edit-reserva").length?"":"disabled";calendar=new FullCalendar.Calendar(o,{stickyFooterScrollbar:!0,datesAboveResources:!0,headerToolbar:{left:"prev,today,next",center:"title",right:"dayGridMonth,dayGridDay,listWeek"},moreLinkText:"Ver más reservas",buttonText:{today:"Actual",month:"Mes",week:"Semana",day:"Dia",list:"Lista"},initialView:e(),themeSystem:"bootstrap",defaultDate:t,locale:"es",navLinks:!0,editable:!0,selectable:!0,events:{url:base+"/calendario/evento_calendario?tipo="+r,type:"get",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"}},eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!1},eventOrder:function(e,a){let t=moment(e.hora_reserva,"HH:mm:ss"),o=moment(a.hora_reserva,"HH:mm:ss");return t.isBefore(o)?-1:o.isBefore(t)?1:0},eventOrderStrict:!0,success:function(e){e.forEach(function(e){e.extendedProps.customData="fecha_reserva",e.extendedProps.customData="hora_reserva",e.extendedProps.customData="id_reserva",e.extendedProps.customData="tipo_reserva",e.extendedProps.customData="tsucursal",e.extendedProps.customData="testado",e.extendedProps.customData="pax",e.extendedProps.customData="dianoche",e.extendedProps.customData="total_pax",e.extendedProps.customData="classname"})},dayMaxEvents:4,eventDidMount:function(e){e.el.classList.add("evento"),e.el.classList.add(e.event.extendedProps.fecha_reserva),e.el.classList.add(e.event.extendedProps.dianoche),e.el.classList.add(e.event.extendedProps.classname),e.el.classList.add(e.event.extendedProps.id_reserva),e.el.classList.add(e.event.extendedProps.tipo),e.el.classList.add(e.event.extendedProps.tsucursal.replace(/\s/g,"")),e.el.classList.add(e.event.extendedProps.testado.replace(/\s/g,""));let t=e.event.extendedProps.id_reserva;new bootstrap.Popover(e.el,{container:"body",html:!0,content:"<a href='#' class='btn btn-danger btn-sm ml-4 mr-4 mt-2 id-"+t+" cancelar "+a+"' id='can-"+t+"' tittle='Cancelar Reserva' data-toggle='modal' data-target='#mdl-vreserva' >C</a><a href='#'class='btn btn-primary btn-sm ml-4 mr-4 mt-2 mx-1 noshow "+n+"' tittle='No Show'>NS</a><a href='#'class='btn btn-success btn-sm ml-4 mr-4 mt-2 mostrar' id='most-"+t+"' tittle='Mostrar'>Mostrar</a><a href='#'class='btn btn-warning btn-sm ml-4 mr-4 mt-2 mx-1 editar "+l+"' id='edit-"+t+"' tittle='Editar Reserva'>Editar</a> <br/>ID: "+t+"<br/>Turno: "+e.event.extendedProps.dianoche+"<br/>Hora: "+moment(e.event.extendedProps.hora_reserva,"HH:mm:ss").format("HH:mm")+"<br/>Sucursal: "+e.event.extendedProps.tsucursal+"<br />Estado: "+e.event.extendedProps.testado+"<br />PAX: "+e.event.extendedProps.pax+"<br/>Tipo Reserva: "+e.event.extendedProps.tipo,title:"<div class='d-flex justify-content-end'><a href='#' class='close text-right' data-dismiss='popover' aria-label= 'Close'><span aria-hidden='true'>&times;</span></a></div>"})},viewWillUnmount:function(e){},viewDidMount:function(e){},dayCellContent:function(e){},eventMouseEnter:function(e){let a=document.createElement("div");a.classList.add("popover"),a.classList.add("titulo_evento"),a.textContent=e.el.text,document.body.appendChild(a);let t=e.el,o=t.getBoundingClientRect(),n=a.getBoundingClientRect(),r=window.scrollY;a.style.top=o.top-n.height+r+"px",a.style.left=o.left+o.width/2-n.width/2+"px";let l=function(){a.remove()};a.addEventListener("mouseleave",l),t.addEventListener("mouseleave",l)},dateClick:function(e){},slotLabelClassNames:function(e){},slotLabelFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:!1,meridiem:"short"},slotLabelContent:function(e){},eventContent:function(e){let a=e.event.extendedProps.pax,t=moment(e.event.start).format("HH:mm"),o=e.event.title;if(o.length>8){var n=o.substring(0,8);o=n+" ..."}return t+" "+a+" "+o},datesSet:function(e){let a=calendar.getDate();a=moment(a).format("YYYY-MM-DD")}}),$.LoadingOverlay("hide"),calendar.render()}var t=new Date,o=(t.getDate(),t.getMonth(),t.getFullYear(),document.getElementById("calendar"));let n=["anticipo","valor_menu","total_s_propina","total_c_propina","pax","pasajeros"];n.forEach(function(e){$("#"+e).on("input",function(e){$(this).val($(this).val().replace(/[^0-9]/g,""))})}),$.ajaxSetup({async:!0,headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},type:"json"});$('meta[name="_token"]').attr("content"),$('meta[name="_token"]').attr("content");$.ajax({url:base+"/reservar/estados",type:"GET",dataType:"json",async:!0,headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"}}).done(function(e){e.forEach(function(e){if(11!=e.id){let a='<option value="'+e.id+'">'+e.estado+"</option>";$("#selEstado").append(a)}}),$("#selEstado").selectpicker({liveSearch:!0,actionsBox:!0,selectAllText:"Seleccionar Todos",deselectAllText:"Deseleccionar Todos"}),$("#selEstado option").not('[value="4"]').not('[value="7"]').not('[value="8"]').prop("selected",!0),$("#selEstado").selectpicker("refresh")});var r=[2,1];a(),calendar.render(),$("#bg-success").on("click",function(){$("#bg-success").is(":checked")?r.push(1):r=r.filter(e=>1!==e),a()}),$("#bg-secondary").on("click",function(){$("#bg-secondary").is(":checked")?r.push(2):r=r.filter(e=>2!==e),a()}),$("#bg-danger").on("click",function(){$("#bg-danger").is(":checked")?r.push(3):r=r.filter(e=>3!==e),a()}),$("#bg-dark").on("click",function(){$("#bg-dark").is(":checked")?r.push(4):r=r.filter(e=>4!==e),a()}),$("#bg-ocre1").on("click",function(){$("#bg-ocre1").is(":checked")?r.push(5):r=r.filter(e=>5!==e),a()}),$("#bg-ocre2").on("click",function(){$("#bg-ocre2").is(":checked")?r.push(6):r=r.filter(e=>6!==e),a()}),$("#bg-primary").on("click",function(){$("#bg-primary").is(":checked")?r.push(7):r=r.filter(e=>7!==e),a()}),$("#bg-grey1").on("click",function(){$("#bg-grey1").is(":checked")?r.push(8):r=r.filter(e=>8!==e),a()}),$(document).on("shown.bs.popover",function(){$(".close").on("click",function(){$(this).parent().parent().parent().popover("hide")}),$(".cancelar").on("click",function(){$("#clave_usuario").val("");var e=$(this).attr("id").split("-")[1];console.log("numero="+e),listRazonCancelacion(),$("#mdl-cancelar").modal("show")}),$(".noshow").on("click",function(){$("#clave_usuario").val(""),$("#mdl-noshow").modal("show")}),$(".editar").on("click",function(){let e=$(this).attr("id").split("-")[1];editar(e)}),$(".mostrar").on("click",function(){let e=$(this).attr("id").split("-")[1];$.ajax({url:base+"/reservar/get_reserva/"+e,type:"get",dataType:"json",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},success:function(e){$("#fecha_reserva").val(e[0].fecha_reserva),$("#hora_reserva").val(e[0].hora_reserva),$("#pasajeros").val(e[0].cantidad_pasajeros),$("#tipo").val(e[0].tipo),$("#cliente").val(e[0].nombre_cliente),$("#empresa").val(e[0].nombre_empresa),$("#hotel").val(e[0].nombre_hotel),$("#telefono").val(e[0].telefono_cliente),$("#correo").val(e[0].email_clente),$("#sucursal").val(e[0].tsucursal),$("#salon").val(e[0].tsalon),$("#mesa").val(e[0].mesa),$("#observaciones").val(e[0].observaciones),$("#nombre_adicional").val(e[0].evento_nombre_adicional),$("#pax").val(e[0].evento_pax),$("#nombre_contacto").val(e[0].evento_nombre_contacto),$("#telefono_contacto").val(e[0].evento_telefono_contacto),$("#correo_contacto").val(e[0].evento_email_contacto),$("#idioma").val(e[0].evento_idioma),$("#cristaleria").val(e[0].evento_cristaleria),$("#anticipo").val(e[0].evento_anticipo),$("#valor_menu").val(e[0].evento_valor_menu),$("#total_s_propina").val(e[0].evento_total_sin_propina),$("#total_c_propina").val(e[0].evento_total_propina),$("#pago_local").val(e[0].tevento_paga_en_local),$("#audio").val(e[0].tevento_audio),$("#video").val(e[0].tevento_video),$("#video_audio").val(e[0].tevento_video_audio),$("#adicional").val(e[0].tevento_mesa_soporte_adicional),$("#autoriza").val(e[0].autoriza),$("#telefono_autoriza").val(e[0].telefono_autoriza),$("#monto_autorizado").val(e[0].monto_autorizado),$("#menu_impreso").val(e[0].tevento_menu_impreso),$("#table_tent").val(e[0].tevento_table_tent),$("#restriccion").val(e[0].tevento_restriccion_alimenticia),$("#detalle_restriccion").val(e[0].evento_detalle_restriccion),$("#decoracion").val(e[0].evento_decoracion),$("#monta").val(e[0].evento_monta),$("#ubicacion").val(e[0].evento_ubicacion),$("#comentarios").val(e[0].evento_comentarios),$("#rsalon").val(e[0].salon),$("#rmesa").val(e[0].mesa),$("#lnk_menu1").empty(),$("#lnk_menu1").append(imageFormatter(e[0].archivo_1)),$("#lnk_menu2").empty(),$("#lnk_menu2").append(imageFormatter(e[0].archivo_2)),$("#lnk_precuenta").empty(),$("#lnk_precuenta").append(imageFormatter(e[0].archivo_3)),$("#lnk_factura").empty(),$("#lnk_factura").append(imageFormatter(e[0].archivo_4)),$("#lnk_otro").empty(),$("#lnk_otro").append(imageFormatter(e[0].archivo_5)),$("#lnk_logo").empty(),$("#lnk_logo").append(imageFormatter(e[0].evento_logo)),$("#tipo_reserva").hide(),$("#ssucursal").hide(),$("#ssalon").hide(),$("#smesa").hide(),$("#div_passwd").hide(),$("#spago_local").hide(),$("#saudio").hide(),$("#svideo").hide(),$("#sextra").hide(),$("#svideo_audio").hide(),$("#sadicional").hide(),$("#smenu_impreso").hide(),$("#stable_tent").hide(),$("#srestriccion").hide(),continuar(e)}})})}),$("#btn-cancelar").on("click",function(){let e=$("#clave_usuario").val();const a={method:"POST",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({clave:e})};fetch(base+"/reservar/verificarclave",a).then(e=>e.json()).then(function(e){if(0==e[0].respuesta)Swal.fire({title:"LA CLAVE INTRODUCIDA ES ERRÓNEA",text:"Verifíquela y vuelva a intentar",icon:"error",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"});else{let e=parseInt($('div:contains("ID:")').text().substr($('div:contains("ID:")').text().indexOf("ID: ")+3,$('div:contains("ID:")').text().indexOf("Sucursal: ")-$('div:contains("ID:")').text().indexOf("ID: ")+3));console.log(e);let a=$("#raz_canc option:selected").val(),t=$("#obs_canc").val();const o={method:"PUT",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({id:e,razon_cancelacion:a,observacion_cancelacion:t})};fetch(base+"/reservar/cancelar",o).then(e=>e.json()).then(function(e){$("#clave_usuario").val(""),$("#raz_canc").val(""),$("#obs_canc").val(""),$("#btn-cerrar").trigger("click"),$("#mdl-cancelar").modal("hide"),$(".popover").popover("hide"),Swal.fire({title:"LA RESERVA HA SIDO CANCELADA EXITOSAMENTE",text:"",icon:"success",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"}),window.location=base+"/calendario/calendario"})}})}),$("#btn-ns").on("click",function(){let e=$("#clave_usuario_es").val();const a={method:"POST",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({clave:e})};fetch(base+"/reservar/verificarclave",a).then(e=>e.json()).then(function(e){if(0==e[0].respuesta)Swal.fire({title:"LA CLAVE INTRODUCIDA ES ERRÓNEA",text:"Verifíquela y vuelva a intentar",icon:"error",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"});else{let e=parseInt($('div:contains("ID:")').text().substr($('div:contains("ID:")').text().indexOf("ID: ")+3,$('div:contains("ID:")').text().indexOf("Sucursal: ")-$('div:contains("ID:")').text().indexOf("ID: ")+3));const a={method:"PUT",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({id:e,estado:7})};fetch(base+"/reservar/cambio_estado",a).then(e=>e.json()).then(function(e){$("#clave_usuario").val(""),$("#btn-cerrar_ns").trigger("click"),$(".popover").popover("hide"),Swal.fire({title:"LA RESERVA HA SIDO CANCELADA EXITOSAMENTE",text:"",icon:"success",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"}),calendar.refetchEvents(),calendar.render()})}})}),$("#btn-bl").on("click",function(){let e=$("#clave_usuario_bl").val();const a={method:"POST",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({clave:e})};fetch(base+"/reservar/verificarclave",a).then(e=>e.json()).then(function(e){if(0==e[0].respuesta)Swal.fire({title:"LA CLAVE INTRODUCIDA ES ERRÓNEA",text:"Verifíquela y vuelva a intentar",icon:"error",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"
});else if(0==$("#fechainicio").val().trim().length||0==$("#horainicio").val().trim().length||0==$("#fechafin").val().trim().length||0==$("#horafin").val().trim().length||0==$("#nombrebloqueo").val().trim().length)Swal.fire({title:"TODOS LOS CAMPOS SON OBLIGATORIOS",text:"Debe proporcionar toda la información solicitada",icon:"error",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"});else if(moment($("#fechainicio").val()).isAfter(moment($("#fechafin").val()))||moment($("#horainicio").val(),"HH:mm:ss").isAfter(moment($("#horafin").val(),"HH:mm:ss")))Swal.fire({title:"¡LA FECHA/HORA DE INICIO ES MAYOR QUE LA DE FINALIZACIÓN!",text:"Tanto la fecha como la hora de finalización del bloqueo deben ser mayores a las de inicio; corrija e intente de nuevo",icon:"error",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"});else if("Bloquear"==$("#btn-bl").html()){let e=[id=0,fecha_inicio=$("#fechainicio").val(),hora_inicio=$("#horainicio").val(),fecha_fin=$("#fechafin").val(),hora_fin=$("#horafin").val(),nombre_bloqueo=$("#nombrebloqueo").val()];const a={method:"POST",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({data:e})};fetch(base+"/reservar/set_bloqueo",a).then(e=>e.json()).then(function(e){204==e[0].resultado?toastr.error("Ha ocurrido un error y no se ha podido bloquear la fecha"):($("#clave_usuario").val(""),$("#btn-cerrar_bloquear").trigger("click"),Swal.fire({title:"LA FECHA HA SIDO BLOQUEADA EXITOSAMENTE",text:"",icon:"success",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"}))})}else if("Editar"==$("#btn-bl").html()){let e=[id=parseInt($("#blq_res").html().substr($("#blq_res").html().indexOf("ID: ")+4).trim()),fecha_inicio=$("#fechainicio").val(),hora_inicio=$("#horainicio").val(),fecha_fin=$("#fechafin").val(),hora_fin=$("#horafin").val(),nombre_bloqueo=$("#nombrebloqueo").val()];const a={method:"POST",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({data:e})};fetch(base+"/reservar/set_bloqueo",a).then(e=>e.json()).then(function(e){204==e[0].resultado?toastr.error("Ha ocurrido un error y no se ha podido bloquear la fecha"):($("#clave_usuario").val(""),$("#btn-cerrar_bloquear").trigger("click"),Swal.fire({title:"LA FECHA HA SIDO BLOQUEADA EXITOSAMENTE",text:"",icon:"success",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"}),location.reload())})}})}),$("#btn-an").on("click",function(){let e=$("#clave_usuario_bl").val();const a={method:"POST",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({clave:e})};fetch(base+"/reservar/verificarclave",a).then(e=>e.json()).then(function(e){if(0==e[0].respuesta)Swal.fire({title:"LA CLAVE INTRODUCIDA ES ERRÓNEA",text:"Verifíquela y vuelva a intentar",icon:"error",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"});else if(0==$("#fechainicio").val().trim().length||0==$("#horainicio").val().trim().length||0==$("#fechafin").val().trim().length||0==$("#horafin").val().trim().length||0==$("#nombrebloqueo").val().trim().length)Swal.fire({title:"TODOS LOS CAMPOS SON OBLIGATORIOS",text:"Debe proporcionar toda la información solicitada",icon:"error",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"});else{let e=parseInt($("#blq_res").html().substr($("#blq_res").html().indexOf("ID: ")+4).trim());const a={method:"GET",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"}};fetch(base+"/reservar/unset_bloqueo/"+e,a).then(e=>e.json()).then(function(e){Swal.fire({title:"EL BLOQUEO HA SIDO ANULADO EXITOSAMENTE",text:"",icon:"success",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"}),$("#clave_usuario").val(""),$("#btn-cerrar_bloquear").trigger("click"),location.reload()})}})}),$("#expanderCalendario").on("click",function(){$(this).hasClass("fa-expand-arrows-alt")?($(".container-fluid").addClass("w-100").removeClass("container-fluid"),$(this).removeClass("fa-expand-arrows-alt"),$(this).addClass("fa-compress-arrows-alt"),$(this).attr("title","Contraer el calendario"),$("#cont").addClass("d-none"),$("#cal").removeClass("col-xl-9").addClass("col-xl-12")):($(".w-100").removeClass("w-100").addClass("container-fluid"),$(this).addClass("fa-expand-arrows-alt"),$(this).removeClass("fa-compress-arrows-alt"),$(this).attr("title","Expandir el calendario"),$("#cal").removeClass("col-xl-12").addClass("col-xl-9"),$("#cont").removeClass("d-none"))}),$(window).width()<800?$("#cal").removeClass("col-xl-9"):$("#cal").addClass("col-xl-9"),etq_pax=!1,setTimeout(()=>{$('.external-event input[type="checkbox"]').prop("checked",!1),$('.external-event:contains("EVENTO")').find('input[type="checkbox"]').prop("checked",!0),$('.external-event:contains("REGULAR")').find('input[type="checkbox"]').prop("checked",!0),filtrarEventos()},3e3)}),$("#mdl-vreserva").on("show.bs.modal",function(){}),$("#mdl-noshow").on("hide.bs.modal",function(){$(".popover").popover("hide")}),$("#mdl-cancelar").on("hide.bs.modal",function(){$(".popover").popover("hide")}),$("#mdl-vreserva").on("hidden.bs.modal",function(){$("fmenu1").val(null),$("fmenu2").val(null),$("#fprecuenta").val(null),$("#ffactura").val(null),$("#fotro").val(null),$("#flogo").val(null),$("#fecha_reserva").val(null),$("#hora_reserva").val(null),$("#spago_local").val(null),$("#saudio").val(null),$("#svideo").val(null),$("#svideo_audio").val(null),$("#adicional").val(null),$("#ubicacion").val(null),$("#smenu_impreso").val(null),$("#stable_tent").val(null),$("#srestriccion").val(null),$("#sextra").val(null),$("#detalle_restriccion").val(null),$("#pasajeros").val(null),$("#tipo_reserva").val(null),$("#cliente").val().trim(null),$("#empresa").val().trim(null),$("#hotel").val().trim(null),$("#telefono").val().trim(null),$("#correo").val().trim(null),$("#ssucursal").val(null),$("#ssalon").val(null),$("#smesa").val(null),$("#observaciones").val().trim(null),$("#nombre_adicional").val().trim(null),$("#pax").val(null),$("#nombre_contacto").val().trim(null),$("#telefono_contacto").val().trim(null),$("#correo_contacto").val().trim(null),$("#idioma").val().trim(null),$("#cristaleria").val().trim(null),$("#anticipo").val(null),$("#valor_menu").val(null),$("#total_s_propina").val(null),$("#total_c_propina").val(null),$("#autoriza").val(null),$("#telefono_autoriza").val(null),$("#monto_autorizado").val(null),$("#decoracion").val(null),$("#monta").val(null),$("#comentarios").val(null),$("#clave").val(""),$("#div_passwd").hide(),$("fmenu1").hide(),$("fmenu2").hide(),$("#fprecuenta").hide(),$("#ffactura").hide(),$("#fotro").hide(),$("#flogo").hide(),$("#id_reserva").html(""),$(".popover.bs-popover-top").popover("hide")}),$("#selEstado").on("change",function(){filtrarEventos()}),$("#selSucursal").on("change",function(){sucursal(1)}),$("#selTurno").on("change",function(){filtrarEventos()}),$("#external-events input").on("change",function(){filtrarEventos()}),$(".archivos").on("click",function(e){e.preventDefault();let a=$(this).html().substr(9,$("#lnk_menu1").html().indexOf("<img")-11);$("#mdl-documento iframe").attr("src",a),$("#mdl-documento").modal("show")}),$("#marcarTipos").on("click",function(){$('.external-event input[type="checkbox"]').prop("checked",!0),filtrarEventos()}),$("#desmarcarTipos").on("click",function(){$('.external-event input[type="checkbox"]').prop("checked",!1),$('.external-event:contains("EVENTO")').find('input[type="checkbox"]').prop("checked",!0),filtrarEventos()}),$("#filtrarEventos").on("click",function(){fechas()}),$("#tipo_reserva").on("change",function(){"EVENTO"==$("#tipo_reserva option:selected").text()||"REGULAR"==$("#tipo_reserva option:selected").text()?($("#pax").val($("#pasajeros").val()),$("#panel_eventos").css("visibility","visible")):$("#panel_eventos").css("visibility","hidden")}),$("#fmenu1,#fmenu2,#fprecuenta,#ffactura,#flogo,#fotro").on("change",function(){let e=$(this).attr("id");switch(e){case"fmenu1":cambiar_archivo("lbl-fmenu1","lnk_menu1",e);break;case"fmenu2":cambiar_archivo("lbl-fmenu2","lnk_menu2",e);break;case"fprecuenta":cambiar_archivo("lbl-fprecuenta","lnk_precuenta",e);break;case"ffactura":cambiar_archivo("lbl-ffactura","lnk_factura",e);break;case"flogo":cambiar_archivo("lbl-flogo","lnk_logo",e);break;case"fotro":cambiar_archivo("lbl-fotro","lnk_otro",e)}}),limpiarArchivos(),$("#btn_reerva").on("click",function(){let e=validar();if(e){let e=$("#clave").val();const a={method:"POST",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({clave:e})};fetch(base+"/reservar/verificarclave",a).then(e=>e.json()).then(function(e){if(0==e[0].respuesta)Swal.fire({title:"LA CLAVE INTRODUCIDA ES ERRÓNEA",text:"Verifíquela y vuelva a intentar",icon:"error",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"});else{fecha=$("#fecha_reserva").val(),hora=$("#hora_reserva").val();const e={method:"GET",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"}};fetch(base+"/reservar/check_bloqueo/"+fecha+"/"+hora,e).then(e=>e.json()).then(function(e){if(e[0].bloqueos>0)Swal.fire({title:"¡BLOQUEO DE FECHA!",text:"La fecha y hora seleccionadas presentan bloqueo; por favor seleccione otra fecha/hora",icon:"error",confirmButtonColor:"#f34e4e",confirmButtonText:"Continuar"});else{let e=$("#cliente").val().trim();const a={method:"POST",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({cliente:e})};fetch(base+"/clientes/buscarliente",a).then(e=>e.json()).then(function(e){if(0==e.respuesta){let e=[tipo="Seleccione"!=$("#tipo option:selected").val()?$("#tipo option:selected").val():0,cliente=$("#cliente").val(),empresa=$("#empresa").val(),hotel=$("#hotel").val(),telefono=$("#telefono").val(),correo=$("#correo").val()];const a={method:"POST",headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content"),"Content-Type":"application/json"},body:JSON.stringify({data:e})};fetch(base+"/clientes/clientemin",a).then(e=>e.json()).then(function(e){if(1==e[0].status)toastr.clear(),toastr.success("reserva actualizada"),actualizar_reserva();else{toastr.clear();let a="";a=e[0].error.indexOf("clientes_tipo_id_foreign")>-1?"No se ha podido crear el cliente debido a que no indicó el tipo de cliente":e[0].error.indexOf("el valor null para la columna «telefono»")>-1?"No se ha podido crear el cliente debido a que no indicó el número de teléfono":"No se ha podido crear el cliente debido a que ocurrió un error",toastr.error(a)}})}else $.LoadingOverlay("show"),actualizar_reserva(),$.LoadingOverlay("hide"),toastr.success("RESERVA ACTUALIZADA")})}})}})}else Swal.fire({title:"¡Tiene campos obligatorios por completar!",text:"Todos los campos maracados con un * son obligatorios, debe proporcionar la información solicitada",icon:"error",confirmButtonColor:"#f34e4e",confirmButtonText:"Regresar"})});